### commitlint

> commitlint å¯ä»¥é…ç½®ä¸€äº›è§„åˆ™ï¼Œå»éªŒè¯`commit message`æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚  
> ä¸€èˆ¬é…åˆ git é’©å­`commit-msg`å»ä½¿ç”¨ã€‚  
> è¿™æ ·æ¯æ¬¡ commit çš„æ—¶å€™éƒ½ä¼šç”± commitlint å¯¹ commit message è¿›è¡Œä¸€æ¬¡æ£€éªŒã€‚éªŒè¯å¤±è´¥çš„è¯ï¼Œå°±ç»ˆæ­¢è¿™æ¬¡æäº¤äº†ã€‚

#### å®‰è£…

`yarn add @commitlint/cli @commitlint/config-conventional -D `

- @commitlint/cli commitlint
  - commitlint å®˜æ–¹å‘½ä»¤è¡Œå·¥å…·ï¼Œè¦ä½¿ç”¨ commitlintï¼Œå¿…é¡»å®‰è£…
- @commitlint/config-conventional
  - commitlint å®˜æ–¹æ¨èè§„èŒƒï¼Œæœ‰æ£€æŸ¥å·¥å…·ï¼Œè¿˜è¦çŸ¥é“æ ¹æ®ä»€ä¹ˆæ£€æŸ¥å˜›ï¼Œæ‰€ä»¥è¦å®‰è£…è¿™ä¸ªè§„èŒƒã€‚
    ![5VcsiA_8XiEuy](https://cdn.jsdelivr.net/gh/NeverStop1024/images-store@main/blog/5VcsiA_8XiEuy.png)
  - ä½†æ˜¯ç¤¾åŒºå¾ˆå¤šä½¿ç”¨ cz-customizable è‡ªå®šä¹‰éªŒè¯è§„åˆ™çš„ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å®‰è£…è¿™ä¸ª`@commitlint/config-conventional`ä¾èµ–

#### é…ç½®

æ ¹ç›®å½•åˆ›å»º`commitlint.config.js`é…ç½®æ–‡ä»¶ï¼Œå…¶å®é…ç½®æ–‡ä»¶ä¸ eslint å¾ˆåƒã€‚

```javascript
// commitlint.config.js
module.exports = {
  // ç»§æ‰¿çš„è§„åˆ™
  extends: ["@commitlint/config-conventional"], // ç»§æ‰¿å®˜æ–¹æ¨èè§„èŒƒ
  // å¯ä»¥è‡ªå®šä¹‰ä¸€äº›è§„åˆ™å»è¦†ç›–
  rules: {
    // type ç±»å‹å®šä¹‰ï¼Œè¡¨ç¤º git æäº¤çš„ type å¿…é¡»åœ¨ä»¥ä¸‹ç±»å‹èŒƒå›´å†…
    "type-enum": [
      2,
      "always",
      [
        "feat", // æ–°åŠŸèƒ½ feature
        "fix", // ä¿®å¤ bug
        "docs", // æ–‡æ¡£æ³¨é‡Š
        "style", // ä»£ç æ ¼å¼(ä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨)
        "refactor", // é‡æ„(æ—¢ä¸å¢åŠ æ–°åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®å¤bug)
        "perf", // æ€§èƒ½ä¼˜åŒ–
        "test", // å¢åŠ æµ‹è¯•
        "chore", // æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
        "revert", // å›é€€
        "build", // æ‰“åŒ…
      ],
    ],
    // subject å¤§å°å†™ä¸åšæ ¡éªŒ
    "subject-case": [0],
  },
};
```

æˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯æ‰§è¡Œ `echo 'feat: bar' | npx --no-install commitlint`ç±»ä¼¼å‘½ä»¤ï¼Œæ¥éªŒè¯æäº¤æ˜¯å¦ç¬¦åˆè§„èŒƒã€‚

##### é‡åˆ°é—®é¢˜

**é—®é¢˜ 1ï¼š**  
å¦‚æœç»ˆç«¯æ‰§è¡Œé‡åˆ°ä¸‹é¢é—®é¢˜
![img_tHe1GN](https://cdn.jsdelivr.net/gh/NeverStop1024/images-store@main/blog/img_tHe1GN.png)  
è¿™æ˜¯ç¼–ç é—®é¢˜ï¼Œè®°äº‹æœ¬æ‰“å¼€ ommitlint.config.jsï¼Œæ”¹ä¸º utf8 å°±å¥½äº†

#### ä½¿ç”¨

husky é…ç½® git é’©å­`npx husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'`  
è¿™æ ·æ¯æ¬¡ git commit æ—¶ï¼Œå°±ä¼šå…ˆä½¿ç”¨ commitlint å»éªŒè¯äº†ã€‚

### commitizen

> ä¸Šé¢è™½ç„¶å®šä¹‰äº†æäº¤è§„èŒƒï¼Œä½†æ˜¯`git commit`æ—¶ï¼Œä»ç„¶éœ€è¦æ‰‹æ•²ï¼Œæœ‰äº›è´¹æ—¶é—´ã€‚  
> åŸºäºè¿™ä¸ªé—®é¢˜ï¼Œæœ‰äº† commitizenï¼Œåªéœ€è¦æ‰§è¡Œ`git cz`åï¼Œé€‰æ‹©è§„èŒƒï¼ŒçœŸæ­£éœ€è¦å¡«å†™çš„åœ°æ–¹å†æ‰‹æ•²ï¼Œå¤§å¤§èŠ‚çœäº†æ—¶é—´ã€‚

#### å®‰è£…

**1.æœ¬åœ°**
`npm install commitizen -D `  
**2.å…¨å±€**
`npm install commitizen -g `

#### é…ç½®

æˆ‘ä»¬ä¸€èˆ¬éƒ½é‡‡ç”¨ç¬¦åˆ Angular çš„ Commit message æ ¼å¼çš„æäº¤è§„èŒƒï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œåé¢ä¼šè®²åˆ°~ï¼‰ã€‚
è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆç¬¦åˆ Angular æäº¤è§„èŒƒæ ¼å¼çš„ Commit messageã€‚

- npm `npx --no-install commitizen init cz-conventional-changelog --save-dev --save-exact`
- yarn `npx --no-install commitizen init cz-conventional-changelog --save-dev --save-exact`  
  å¯ä»¥åœ¨`package.json` ä¸­çœ‹åˆ°ï¼Œè‡ªåŠ¨çš„æ–°å¢äº†ä»¥ä¸‹å†…å®¹

```json
{
  ...
  "config": {
    "commitizen": {
      "path": "./node_modules/cz-conventional-changelog"
    }
  }
  ...
}
```

è¿è¡Œ`yarn cz`å°±å¯ä»¥å»æäº¤ä»£ç äº†ï¼Œå¦‚æœæ˜¯å…¨å±€å®‰è£…çš„ commitizenï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨`git cz`ã€‚
![QZrrBo_4jniXq](https://cdn.jsdelivr.net/gh/NeverStop1024/images-store@main/blog/QZrrBo_4jniXq.png)

### è‡ªå®šä¹‰ commitlint è§„åˆ™

> å¦‚æœéœ€è¦è‡ªå®šä¹‰ commitlint è§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…`cz-customizable`æ¥å®ç°è‡ªå®šä¹‰ commit message è§„åˆ™ï¼Œå¹¶å®‰è£…`commitlint-config-cz`æ¥é…å¥—æ ¡éªŒï¼ˆç›´æ¥ä»è‡ªå®šä¹‰çš„æ–‡ä»¶é‡Œè¯»å–è§„åˆ™ï¼‰

- æ‰§è¡Œ`yarn add commitlint-config-cz cz-customizable -D`è¿›è¡Œå®‰è£…ã€‚
- åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ª`.cz-config.js`æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶å®˜æ–¹ç¤ºä¾‹[cz-config-EXAMPLE.js](https://github.com/leoforfree/cz-customizable/blob/master/cz-config-EXAMPLE.js) ä¸­çš„å†…å®¹åˆ°å…¶ä¸­ã€‚ç„¶åæ”¹æˆæˆ‘ä»¬è‡ªå·±éœ€è¦çš„è§„åˆ™å°±å¯ä»¥ã€‚

ä¸‹é¢æ˜¯ä»½å†™å¥½çš„ï¼š

```javascript
module.exports = {
  types: [
    { value: "feat", name: "feat: ä¸€ä¸ªæ–°çš„ç‰¹æ€§" },
    { value: "fix", name: "fix: ä¿®å¤ä¸€ä¸ªBug" },
    { value: "docs", name: "docs: å˜æ›´çš„åªæœ‰æ–‡æ¡£" },
    { value: "style", name: "style: ä»£ç é£æ ¼,æ ¼å¼ä¿®å¤" },
    { value: "refactor", name: "refactor: ä»£ç é‡æ„ï¼Œæ³¨æ„å’Œfeatã€fixåŒºåˆ†å¼€" },
    { value: "perf", name: "perf: ç ä¼˜åŒ–,æ”¹å–„æ€§èƒ½" },
    { value: "test", name: "test: æµ‹è¯•" },
    { alue: "chore", name: "chore: å˜æ›´æ„å»ºæµç¨‹æˆ–è¾…åŠ©å·¥å…·" },
    { value: "revert", name: "revert: ä»£ç å›é€€" },
    { value: "init", name: "init: é¡¹ç›®åˆå§‹åŒ–" },
    { value: "build", name: "build: å˜æ›´é¡¹ç›®æ„å»ºæˆ–å¤–éƒ¨ä¾èµ–" },
    { value: "WIP", name: "WIP: è¿›è¡Œä¸­çš„å·¥ä½œ" },
  ],
  scopes: [],
  allowTicketNumber: false,
  isTicketNumberRequired: false,
  ticketNumberPrefix: "TICKET-",
  ticketNumberRegExp: "\\d{1,5}",
  // it needs to match the value for field type. Eg.: 'fix'
  /*
  scopeOverrides: {
    fix: [
      {name: 'merge'},
      {name: 'style'},
      {name: 'e2eTest'},
      {name: 'unitTest'}
    ]
  },
  */
  // override the messages, defaults are as follows
  messages: {
    type: "é€‰æ‹©ä¸€ç§ä½ çš„æäº¤ç±»å‹:",
    scope: "é€‰æ‹©ä¸€ä¸ªscope (å¯é€‰):",
    // used if allowCustomScopes is true
    customScope: "Denote the SCOPE of this change:",
    subject: "ç®€çŸ­è¯´æ˜(æœ€å¤š40ä¸ªå­—):",
    body: 'é•¿è¯´æ˜ï¼Œä½¿ç”¨"|"æ¢è¡Œ(å¯é€‰)ï¼š\n',
    breaking: "éå…¼å®¹æ€§è¯´æ˜ (å¯é€‰):\n",
    footer: "å…³è”å…³é—­çš„issueï¼Œä¾‹å¦‚ï¼š#12, #34(å¯é€‰):\n",
    confirmCommit: "ç¡®å®šæäº¤?",
  },
  allowCustomScopes: true,
  allowBreakingChanges: ["feat", "fix"],
  // skip any questions you want
  skipQuestions: ["scope", "body", "breaking"],
  // limit subject length
  subjectLimit: 100,
  // breaklineChar: '|', // It is supported for fields body and footer.
  // footerPrefix : 'ISSUES CLOSED:'
  // askForBreakingChangeFirst : true, // default is false
};
```

- åˆ›å»ºå®Œ`.cz-config.js`æ–‡ä»¶åï¼Œæˆ‘ä»¬éœ€è¦å›åˆ° `package.json` æ–‡ä»¶ä¸­ï¼Œå°† `config.commitizen.path` æ›´æ”¹ä¸º`"node_modules/cz-customizable"`
- ã€è¿™æ¡å¯ä»¥ä¸é…ç½®ã€‘å¦‚æœä½ çš„.cz-config.js æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆå¯ä»¥ä¸é…ç½®`cz-customizable.config`ï¼Œcommitlint-config-cz ä¼šè‡ªåŠ¨åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹å¯»æ‰¾: `.cz-config.js`æˆ– `.config/cz-config.js`

```json
// package.json
// ...
{
  "config": {
    "commitizen": {
      "path": "node_modules/cz-customizable"
    },
    // å¦‚æœä½ çš„.cz-config.jsæ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆå¯ä»¥ä¸é…ç½®ä¸‹é¢è¿™æ¡ï¼Œcommitlint-config-czä¼šè‡ªåŠ¨åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹å¯»æ‰¾: .cz-config.js æˆ– .config/cz-config.js
    "cz-customizable": {
      "config": "ä½ çš„æ–‡ä»¶è·¯å¾„/xxxconfig.js"
    }
  }
}
// ...
```

æ›´æ”¹`commitlint.config.js`,extends æ”¹ä¸º`cz`

```javascript
module.exports = {
  // extends: ["@commitlint/config-conventional"],
  extends: ["cz"],
};
```

å®Œç»“ï¼Œæ’’èŠ± ğŸ‰
